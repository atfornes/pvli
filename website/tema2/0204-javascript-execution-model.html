<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title></title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">



  <link rel="stylesheet" href="../shared/lib/reveal/../tabzilla/css/tabzilla.css"/>
  <link rel="stylesheet" href="../shared/lib/reveal/css/theme/mozilla-devrel-light.css"/>

  <link rel="stylesheet" href="../shared/lib/reveal/lib/css/solarized-light.css" />




  <link rel="stylesheet" href="../shared/lib/reveal/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
<!--  -->
<!--   <link rel="stylesheet" href="../shared/lib/reveal/css/theme/black.css" id="theme"> -->
<!--  -->
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? '../shared/lib/reveal/css/print/pdf.css' : '../shared/lib/reveal/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="../shared/lib/reveal/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>


<!-- FIXME megahack because `pandoc` only generates h1's. -->
<style type="text/css">
    .level2 h1 {
        
    border-top: 0.1em solid #484848;
    border-bottom: 0.1em solid #484848;
    
    padding: 1em 0;
    margin-bottom: 1em;
    font-size: 1.6em;
    margin: 0 0 20px 0;
    color: #484848;
    font-family: "Fira Sans", Helvetica, sans-serif;
    font-weight: 600;
    line-height: 1.2;
    letter-spacing: normal;
    text-transform: uppercase;
    text-shadow: none;
    word-wrap: break-word;
}

</style>


</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="el-modelo-de-ejecución-de-javascript" class="slide level1">
<h1>El modelo de ejecución de JavaScript</h1>
<p>JavaScript se caracteriza por presentar un modelo de ejecución asíncrono donde los resultados <strong>no se encuentran disposibles inmediatamente</strong> sino que lo estarán en un futuro.</p>
<h2 id="ámbito-y-hoisting">Ámbito y <em>hoisting</em></h2>
<p>Como en muchos lenguajes, los nombres de las variables <strong>pueden reutilizarse</strong> y guardar valores distintos siempre y cuando se encuentren en <strong>ámbitos distintos</strong>.</p>
<p>El ámbito o <em>scope</em> de una variable es la porción de código donde puede ser utilizada. <strong>Variables con el mismo nombre en ámbitos distintos son variables distintas</strong>.</p>
<p>El <strong>ámbito en JavaScript es el cuerpo de la función</strong>, delimitado entre el par de llaves <code>{</code> y <code>}</code> que siguen a la lista de parámetros de la función.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">introduction</span>() <span class="op">{</span>
  <span class="co">// Esta es la variable text.</span>
  <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;I</span><span class="sc">\&#39;</span><span class="st">m Ziltoid, the Omniscient.&#39;</span><span class="op">;</span>
  <span class="at">greetings</span>()<span class="op">;</span>
  <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
<span class="op">}</span>

<span class="kw">function</span> <span class="at">greetings</span>(list) <span class="op">{</span>
  <span class="co">// Y esta es OTRA variable text distinta.</span>
  <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;Greetings humans!&#39;</span><span class="op">;</span>
  <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
<span class="op">}</span>

<span class="at">introduction</span>()<span class="op">;</span></code></pre></div>
<p>En JavaScript, las funciones pueden definirse dentro de otras funciones y de esta forma, anidar ámbitos.</p>
<p>El aniadmiento de funciones es útil cuando se quieren usar <strong>pequeñas funciones auxiliares</strong>.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">getEven</span>(list) <span class="op">{</span>
  <span class="kw">function</span> <span class="at">isEven</span>(n) <span class="op">{</span>
    <span class="cf">return</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span><span class="op">;</span>
  <span class="op">}</span>
  <span class="cf">return</span> <span class="va">list</span>.<span class="at">filter</span>(isEven)<span class="op">;</span>
<span class="op">}</span>

<span class="at">getEven</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>])<span class="op">;</span></code></pre></div>
<p>Como el ámbito es el de la función, el mismo nombre en una función anidada se puede referir a dos cosas:</p>
<p><strong>Si se usa con <code>var</code></strong>, se estará declarando <strong>otra variable distinta</strong>:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">introduction</span>() <span class="op">{</span>
  <span class="co">// Esta es una variable text.</span>
  <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;I</span><span class="sc">\&#39;</span><span class="st">m Ziltoid, the Omniscient.&#39;</span><span class="op">;</span>

  <span class="kw">function</span> <span class="at">greetings</span>(list) <span class="op">{</span>
    <span class="co">// Y esta es OTRA variable text distinta.</span>
    <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;Greetings humans!&#39;</span><span class="op">;</span>
    <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
  <span class="op">}</span>

  <span class="at">greetings</span>()<span class="op">;</span>
  <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
<span class="op">}</span>

<span class="at">introduction</span>()<span class="op">;</span></code></pre></div>
<p>En el caso anterior, decimos que la variable <code>text</code> de la función anidada <code>greetings()</code> oculta a la variable <code>text</code> de la función <code>introduction()</code>.</p>
<p>Recuerda que para introducir una <strong>nueva variable</strong> necesitas declararla con <code>var</code> antes de usarla (o al mismo tiempo que la asignas).</p>
<p>Si omites la palabra <code>var</code>, no estás creando una nueva variable sino <strong>reutilizando</strong> la que ya existía.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">introduction</span>() <span class="op">{</span>
  <span class="co">// Esta es una variable text.</span>
  <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;I</span><span class="sc">\&#39;</span><span class="st">m Ziltoid, the Omniscient.&#39;</span><span class="op">;</span>

  <span class="kw">function</span> <span class="at">greetings</span>(list) <span class="op">{</span>
    <span class="co">// Esta es la MISMA variable text que la de afuera.</span>
    text <span class="op">=</span> <span class="st">&#39;Greetings humans!&#39;</span><span class="op">;</span>
    <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
  <span class="op">}</span>

  <span class="at">greetings</span>()<span class="op">;</span>
  <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
<span class="op">}</span>

<span class="at">introduction</span>()<span class="op">;</span></code></pre></div>
<h3 id="hoisting">Hoisting</h3>
<p>En JavaScript da igual a qué altura de la función declares una variable. JavaScript asumirá cualquier declaración como si ocurriese al comienzo de la función.</p>
<p>Es decir que esto:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">f</span>() <span class="op">{</span>
  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span>
    <span class="cf">for</span> (<span class="kw">var</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> j<span class="op">++</span>) <span class="op">{</span>
      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;i: &#39;</span><span class="op">,</span> i<span class="op">,</span> <span class="st">&#39; j: &#39;</span><span class="op">,</span> j)<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Es equivalente a esto:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">f</span>() <span class="op">{</span>
  <span class="kw">var</span> i<span class="op">;</span>
  <span class="kw">var</span> j<span class="op">;</span>
  <span class="cf">for</span> (i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span>
    <span class="cf">for</span> (j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> j<span class="op">++</span>) <span class="op">{</span>
      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;i: &#39;</span><span class="op">,</span> i<span class="op">,</span> <span class="st">&#39; j: &#39;</span><span class="op">,</span> j)<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Fíjate que JavaScript <strong><em>alza</em> la declaración de la variable, no la inicialización</strong>. Es por eso que este código no falla pero imprime <code>undefined</code>:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">f</span>() <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(i)<span class="op">;</span>
  <span class="kw">var</span> i <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>
<span class="op">}</span>
<span class="at">f</span>()<span class="op">;</span></code></pre></div>
<p>En modo estricto, usar una variable que no ha sido declarada <strong>es un error</strong>.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">f</span>() <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(i)<span class="op">;</span> <span class="co">// comenta esto después de probar f.</span>
  i <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>
<span class="op">}</span>
<span class="at">f</span>()<span class="op">;</span></code></pre></div>
<p>Con las declaraciones de funciones esto no pasa, cuando una declaración de función se alza, se alza entera, <strong>definición incluída</strong>.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">getEven</span>(list) <span class="op">{</span>
  <span class="cf">return</span> <span class="va">list</span>.<span class="at">filter</span>(isEven)<span class="op">;</span>

  <span class="kw">function</span> <span class="at">isEven</span>(n) <span class="op">{</span>
    <span class="cf">return</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span><span class="op">;</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="at">getEven</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>])<span class="op">;</span></code></pre></div>
<p>Esto permite una bonita forma de ordenar el código en el que las funciones auxiliares pueden situarse más abajo en las funciones que las utilicen.</p>
<p>Así, viendo sólo la línea:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript">  <span class="cf">return</span> <span class="va">list</span>.<span class="at">filter</span>(isEven)<span class="op">;</span></code></pre></div>
<p>Ya podemos saber qué significa.</p>
<p>Y si aun tenemos dudas, podemos bajar e investigar qué es esa función.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript">  <span class="kw">function</span> <span class="at">isEven</span>(n) <span class="op">{</span>
    <span class="cf">return</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span><span class="op">;</span>
  <span class="op">}</span></code></pre></div>
<h2 id="closures"><em>Closures</em></h2>
<p>Las funciones son datos y se crean cada vez que se encuentra una instrucción <code>function</code>. De esta forma podemos crear una función que devuelva funciones.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">buildFunction</span>() <span class="op">{</span>
  <span class="cf">return</span> <span class="kw">function</span> () <span class="op">{</span> <span class="cf">return</span> <span class="dv">42</span><span class="op">;</span> <span class="op">};</span>
<span class="op">}</span>

<span class="kw">var</span> f <span class="op">=</span> <span class="at">buildFunction</span>()<span class="op">;</span>
<span class="kw">var</span> g <span class="op">=</span> <span class="at">buildFunction</span>()<span class="op">;</span>

<span class="kw">typeof</span> f <span class="op">===</span> <span class="st">&#39;function&#39;</span><span class="op">;</span>
<span class="kw">typeof</span> g <span class="op">===</span> <span class="st">&#39;function&#39;</span><span class="op">;</span>

<span class="at">f</span>()<span class="op">;</span>
<span class="at">g</span>()<span class="op">;</span> <span class="co">// Las funciones hacen lo mismo...</span>

f <span class="op">!==</span> g<span class="op">;</span> <span class="co">// ...pero NO son la misma función</span></code></pre></div>
<p>Por sí sólo, este no es un mecanismo muy potente pero sabiendo que una función anidada puede acceder a las variables de los ámbitos superiores, podemos hacer algo así:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">newDie</span>(sides) <span class="op">{</span>
  <span class="cf">return</span> <span class="kw">function</span> () <span class="op">{</span>
    <span class="cf">return</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
  <span class="op">};</span>
<span class="op">}</span>
<span class="kw">var</span> d100 <span class="op">=</span> <span class="at">newDie</span>(<span class="dv">100</span>)<span class="op">;</span>
<span class="kw">var</span> d20 <span class="op">=</span> <span class="at">newDie</span>(<span class="dv">20</span>)<span class="op">;</span>

d100 <span class="op">!==</span> d20<span class="op">;</span> <span class="co">// distintas, creadas en dos llamadas distintas a newDie.</span>

<span class="at">d100</span>()<span class="op">;</span>
<span class="at">d20</span>()<span class="op">;</span></code></pre></div>
<p>En JavaScript, <strong>las funciones retienen el acceso a las variables en ámbitos superiores</strong>.</p>
<p>Una <strong>función que se refiere a alguna de las variables en ámbitos superiores se denomina <em>closure</em></strong>.</p>
<p>Esto <strong>no afecta al valor de <code>this</code></strong> que seguirá siendo <strong>el destinatario del mensaje</strong>.</p>
<h3 id="métodos-closures-y-this">Métodos, closures y <code>this</code></h3>
<p>Considera el siguiente ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> diceUtils <span class="op">=</span> <span class="op">{</span>
  <span class="dt">history</span><span class="op">:</span> []<span class="op">,</span> <span class="co">// lleva el histórico de tiradas.</span>

  <span class="dt">newDie</span><span class="op">:</span> <span class="kw">function</span> (sides) <span class="op">{</span>
    <span class="cf">return</span> <span class="kw">function</span> <span class="at">die</span>() <span class="op">{</span>
      <span class="kw">var</span> result <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
      <span class="kw">this</span>.<span class="va">history</span>.<span class="at">push</span>([<span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span> sides<span class="op">,</span> result])<span class="op">;</span>
      <span class="cf">return</span> result<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Nuestra intención es poder crear dados y llevar un registro de todas las tiradas que se hagan con estos dados.</p>
<p>Pero esto no funciona:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> d10 <span class="op">=</span> <span class="va">diceUtils</span>.<span class="at">newDie</span>(<span class="dv">10</span>)<span class="op">;</span>
<span class="at">d10</span>()<span class="op">;</span> <span class="co">// ¡error!</span></code></pre></div>
<p>Y es así porque <strong><code>this</code> siempre es el destinatario del mensaje</strong> y <code>d10</code> se está llamando como si fuera una función y no un método.</p>
<p>Recordad que podíamos hacer que cualquier función tomara un valor forzoso como <code>this</code> con <code>.apply()</code> por lo que esto sí funciona pero es un engorro:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="va">d10</span>.<span class="at">apply</span>(diceUtils)<span class="op">;</span>
<span class="va">d10</span>.<span class="at">apply</span>(diceUtils)<span class="op">;</span>
<span class="va">diceUtils</span>.<span class="at">history</span><span class="op">;</span></code></pre></div>
<p>Lo que tenemos que hacer es que la función <code>die</code> dentro de <code>newDie</code> se refiera al <code>this</code> del ámbito superior, no al suyo.</p>
<p>Podemos hacer esto de dos maneras. La primera es un mero juego de variables:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> diceUtils <span class="op">=</span> <span class="op">{</span>
  <span class="dt">history</span><span class="op">:</span> []<span class="op">,</span> <span class="co">// Lleva el histórico de dados.</span>

  <span class="dt">newDie</span><span class="op">:</span> <span class="kw">function</span> (sides) <span class="op">{</span>
    <span class="kw">var</span> self <span class="op">=</span> <span class="kw">this</span><span class="op">;</span> <span class="co">// self es ahora el destinatario de newDie.</span>
    <span class="cf">return</span> <span class="kw">function</span> <span class="at">die</span>() <span class="op">{</span>
      <span class="kw">var</span> result <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
      <span class="co">// Usando self nos referimos al destinatario de newDie.</span>
      <span class="va">self</span>.<span class="va">history</span>.<span class="at">push</span>([<span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span> sides<span class="op">,</span> result])<span class="op">;</span>
      <span class="cf">return</span> result<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Esto sí funciona y es mucho más conveniente:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> d10 <span class="op">=</span> <span class="va">diceUtils</span>.<span class="at">newDie</span>(<span class="dv">10</span>)<span class="op">;</span>
<span class="kw">var</span> d6 <span class="op">=</span> <span class="va">diceUtils</span>.<span class="at">newDie</span>(<span class="dv">6</span>)<span class="op">;</span>
<span class="at">d10</span>()<span class="op">;</span>
<span class="at">d6</span>()<span class="op">;</span>
<span class="at">d10</span>()<span class="op">;</span>
<span class="va">diceUtils</span>.<span class="at">history</span><span class="op">;</span></code></pre></div>
<p>La segunda forma es usando el método <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_objects/Function/bind"><code>bind()</code></a> de las funciones.</p>
<p>El método <code>bind()</code> de una función <strong>devuelve otra función cuyo <code>this</code> será el primer parámetro de <code>bind()</code></strong>. De este modo:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> diceUtils <span class="op">=</span> <span class="op">{</span>
  <span class="dt">history</span><span class="op">:</span> []<span class="op">,</span> <span class="co">// Lleva el histórico de dados.</span>

  <span class="dt">newDie</span><span class="op">:</span> <span class="kw">function</span> (sides) <span class="op">{</span>
    <span class="cf">return</span> <span class="va">die</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span> <span class="co">// una nueva función que llamará a die con su</span>
                           <span class="co">// destinatario establecido al primer parámetro.</span>

    <span class="kw">function</span> <span class="at">die</span>() <span class="op">{</span>
      <span class="kw">var</span> result <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
      <span class="kw">this</span>.<span class="va">history</span>.<span class="at">push</span>([<span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span> sides<span class="op">,</span> result])<span class="op">;</span>
      <span class="cf">return</span> result<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>Las dos formas son <strong>ampliamente utilizadas</strong> pero la segunda se ve escrita muchas veces de este modo:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> diceUtils <span class="op">=</span> <span class="op">{</span>
  <span class="dt">history</span><span class="op">:</span> []<span class="op">,</span> <span class="co">// Lleva el histórico de dados.</span>

  <span class="dt">newDie</span><span class="op">:</span> <span class="kw">function</span> (sides) <span class="op">{</span>
    <span class="cf">return</span> <span class="kw">function</span> <span class="at">die</span>() <span class="op">{</span>
      <span class="kw">var</span> result <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
      <span class="kw">this</span>.<span class="va">history</span>.<span class="at">push</span>([<span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span> sides<span class="op">,</span> result])<span class="op">;</span>
      <span class="cf">return</span> result<span class="op">;</span>
    <span class="op">}</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span> <span class="co">// el bind sigue a la expresión de función.</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<h2 id="diferencias-entre-ámbitos-en-node-y-el-navegador">Diferencias entre ámbitos en node y el navegador</h2>
<p>Hemos dicho que el ámbito en JavaScript es equivalente a la función pero sabemos que podemos abrir una consola o un fichero y empezar a declarar variables sin necesidad de escribir una función.</p>
<p>Esto es así porque estamos usando el <strong>ámbito global</strong>. El ámbito global está <strong>disponible en el navegador y en node</strong>.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Esta es una variable text en el ámbito GLOBAL.</span>
<span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;I</span><span class="sc">\&#39;</span><span class="st">m Ziltoid, the Omniscient.&#39;</span><span class="op">;</span>

<span class="co">// Esta es una función en el ámbito GLOBAL.</span>
<span class="kw">function</span> <span class="at">greetings</span>(list) <span class="op">{</span>
  <span class="co">// Esta es OTRA variable text en el ámbito de la función.</span>
  <span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;Greetings humans!&#39;</span><span class="op">;</span>
  <span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span>
<span class="op">}</span>

<span class="at">greetings</span>()<span class="op">;</span>
<span class="va">console</span>.<span class="at">log</span>(text)<span class="op">;</span></code></pre></div>
<p>Sin embargo, existe una peculiaridad en node. El ámbito global es realmente <strong>local al fichero</strong>. Esto quiere decir que:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// En a.js, text es visible únicamente dentro del FICHERO.</span>
<span class="st">&quot;use strict&quot;</span><span class="op">;</span>
<span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;I</span><span class="sc">\&#39;</span><span class="st">m Ziltoid, the Omniscient.&#39;</span><span class="op">;</span>

<span class="co">// En b.js, text es visible únicamente dentro del FICHERO.</span>
<span class="st">&quot;use strict&quot;</span><span class="op">;</span>
<span class="kw">var</span> text <span class="op">=</span> <span class="st">&#39;Greetings humans!&#39;</span><span class="op">;</span>

<span class="co">// En una consola iniciada en el mismo directorio que a y b</span>
<span class="at">require</span>(<span class="st">&#39;./a&#39;</span>)<span class="op">;</span>
<span class="at">require</span>(<span class="st">&#39;./b&#39;</span>)<span class="op">;</span>
text<span class="op">;</span></code></pre></div>
<h2 id="módulos">Módulos</h2>
<p>Esta sección presenta la característica <em>módulos</em> que es específica de node.</p>
<p>Una de las principales desventajas de JavaScript (<a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/import">hasta la próxima versión</a>) es que no hay forma de organizar el código en módulos.</p>
<p>Los módulos sirven para aglomerar funcionalidad relacionada: tipos, funciones, constantes, configuración...</p>
<p><strong>Node sí tiene módulos</strong> y, afortunadamente, existen herramientas que simulan módulos como los de node en el navegador.</p>
<p>En node, <strong>los ficheros JavaScript acabados en <code>.js</code> son módulos</strong>.</p>
<p>Node permite exponer o <strong>exportar funcionalidad de un módulo</strong>:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// En diceUtils.js</span>
<span class="st">&quot;use strict&quot;</span><span class="op">;</span> <span class="co">// pone el módulo en modo estricto.</span>

<span class="kw">var</span> history <span class="op">=</span> []<span class="op">;</span>

<span class="kw">function</span> <span class="at">newDie</span>(sides) <span class="op">{</span>
  <span class="cf">return</span> <span class="kw">function</span> <span class="at">die</span>() <span class="op">{</span>
    <span class="kw">var</span> result <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">Math</span>.<span class="at">random</span>() <span class="op">*</span> sides) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>
    <span class="va">history</span>.<span class="at">push</span>([<span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span> sides<span class="op">,</span> result])<span class="op">;</span>
    <span class="cf">return</span> result<span class="op">;</span>
  <span class="op">};</span>
<span class="op">}</span>

<span class="co">// ¡Lo que se exporta realmente es el objeto module.exports!</span>
<span class="va">module</span>.<span class="va">exports</span>.<span class="at">newDie</span> <span class="op">=</span> newDie<span class="op">;</span>
<span class="va">module</span>.<span class="va">exports</span>.<span class="at">history</span> <span class="op">=</span> history<span class="op">;</span></code></pre></div>
<p>Poniéndola dentro del objeto <code>module.exports</code></p>
<p>Realmente, lo que se exporta es <strong>siempre <code>module.exports</code></strong>, que en principio es un objeto vacío:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">typeof</span> <span class="va">module</span>.<span class="at">exports</span><span class="op">;</span>
<span class="va">module</span>.<span class="at">exports</span><span class="op">;</span></code></pre></div>
<p>Lo que pongas dentro, queda también exportado.</p>
<p>Aahora puedes <strong>importarlo desde otro módulo</strong>:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// En cthulhuRpg.js</span>
<span class="st">&quot;use strcit&quot;</span>
<span class="kw">var</span> diceUtils <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./diceUtils&#39;</span>)<span class="op">;</span>
<span class="kw">var</span> d100 <span class="op">=</span> <span class="va">diceUtils</span>.<span class="at">newDie</span>(<span class="dv">100</span>)<span class="op">;</span>
<span class="kw">var</span> howard <span class="op">=</span> <span class="op">{</span>
  <span class="dt">sanity</span><span class="op">:</span> <span class="dv">45</span><span class="op">,</span>
  <span class="dt">sanityCheck</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span>
    <span class="cf">if</span> (<span class="at">d100</span>() <span class="op">&lt;=</span> <span class="kw">this</span>.<span class="at">sanity</span>) <span class="op">{</span>
      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Horrible, pero lo superaré. Estuvo cerca.&#39;</span>)<span class="op">;</span>
    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>
      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;¡Ph</span><span class="sc">\&#39;</span><span class="st">nglui mglw</span><span class="sc">\&#39;</span><span class="st">nafh Cthulhu R</span><span class="sc">\&#39;</span><span class="st">lyeh wgah</span><span class="sc">\&#39;</span><span class="st">nagl fhtagn!&#39;</span>)<span class="op">;</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">};</span>
<span class="va">howard</span>.<span class="at">sanityCheck</span>()<span class="op">;</span></code></pre></div>
<p>Para importar un módulo desde otro hay que pasar a <a href="https://nodejs.org/api/modules.html#modules_module_require_id"><code>require</code></a> <strong>la ruta relativa hasta el fichero del módulo</strong> que queremos importar <strong>sin extensión</strong>. La ruta <strong>es relativa al fichero que quiere importar</strong>.</p>
<p>Si en lugar de una ruta, pasamos un nombre, accederemos a la <strong>funcionalidad que viene por defecto con node</strong> o la que instalemos de terceras partes. Usaremos esta forma en un par de ocasiones más adelante.</p>
<h2 id="programación-asíncrona-y-eventos">Programación asíncrona y eventos</h2>
<p>Prueba el siguiente ejemplo (copia, pega y espera 5 segundos):</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> fiveSeconds <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">1000</span><span class="op">;</span> <span class="co">// en milisegundos.</span>

<span class="co">// Esto ocurre ahora.</span>
<span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;T: &#39;</span><span class="op">,</span> <span class="kw">new</span> <span class="at">Date</span>())<span class="op">;</span>

<span class="at">setTimeout</span>(<span class="kw">function</span> () <span class="op">{</span>
  <span class="co">// Esto ocurre pasados 5 segundos.</span>
  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;T + 5 segundos: &#39;</span><span class="op">,</span> <span class="kw">new</span> <span class="at">Date</span>())<span class="op">;</span>
<span class="op">},</span> fiveSeconds)<span class="op">;</span>

<span class="co">// Esto ocurre inmediatamente después</span>
<span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;T + delta: &#39;</span><span class="op">,</span> <span class="kw">new</span> <span class="at">Date</span>())<span class="op">;</span></code></pre></div>
<p>Como puedes comprobar, el mensaje se completa pasados 5 segundos porque lo que hace <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout"><code>setTimeout</code></a> es llamar a la función tan pronto como pasen el número de milisegundos indicados.</p>
<p>Decimos que una función es una <strong><em>callback</em></strong> si se llama en algún momento futuro, es decir, <strong>asíncronamente</strong>, para informar de algún resultado.</p>
<p>En el ejemplo de <code>setTimeout</code> el resultado es que ha pasado la cantidad de tiempo especificada.</p>
<h3 id="eventos">Eventos</h3>
<p>Esta sección presenta el módulo <code>readline</code> que es específico de node.</p>
<p>La programación asíncrona en JavaScript y otros lenguajes se usa para <strong>modelar eventos</strong>, principalmente <strong>esperas por entrada y salida</strong>.</p>
<p>En otras palabras: hitos que ocurren pero que <strong>no sabemos cuándo ocurren</strong>.</p>
<p>La entrada y salida, a partir de ahora IO (del inglés <em>input / output</em>), no solo supone lectura de ficheros o peticiones a la red, también incluye esperar por una acción del usuario.</p>
<p>Vamos a implementar una consola de diálogo por líneas. Usaremos el módulo <a href="https://nodejs.org/api/readline.html"><code>readline</code></a> que es parte de la funcionalidad que vienen con node:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// En conversational.js</span>
<span class="st">&quot;use strict&quot;</span><span class="op">;</span>

<span class="kw">var</span> readline <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;readline&#39;</span>)<span class="op">;</span>

<span class="kw">var</span> cmd <span class="op">=</span> <span class="va">readline</span>.<span class="at">createInterface</span>(<span class="op">{</span>
  <span class="dt">input</span><span class="op">:</span> <span class="va">process</span>.<span class="at">stdin</span><span class="op">,</span>  <span class="co">// así referenciamos la consola como entrada.</span>
  <span class="dt">output</span><span class="op">:</span> <span class="va">process</span>.<span class="at">stdout</span><span class="op">,</span> <span class="co">// y así, como salida.</span>
  <span class="dt">prompt</span><span class="op">:</span> <span class="st">&#39;(╯°□°）╯ &#39;</span> <span class="co">// lo que aparece para esperar la entrada del usuario.</span>
<span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p>Lanza ese programa con node y verás que no hace nada <strong>pero tampoco termina</strong>. Esto es típico de los programas asíncronos. El programa queda esperando a que pase algo. Pulsa <code>ctrl+c</code> para terminar el programa.</p>
<p>Ahora prueba:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Añade al final de conversational.js</span>
<span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Escribe algo y pulsa enter&#39;</span>)<span class="op">;</span>
<span class="va">cmd</span>.<span class="at">prompt</span>()<span class="op">;</span> <span class="co">// pide que el usuario escriba algo.</span>

<span class="va">cmd</span>.<span class="at">on</span>(<span class="st">&#39;line&#39;</span><span class="op">,</span> <span class="kw">function</span> (input) <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Has dicho &quot;&#39;</span> <span class="op">+</span> input  <span class="op">+</span> <span class="st">&#39;&quot;&#39;</span>)<span class="op">;</span>
  <span class="va">cmd</span>.<span class="at">prompt</span>()<span class="op">;</span> <span class="co">// pide que el usuario escriba algo.</span>
<span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p>Lo que has conseguido es <strong>escuchar por el evento <code>line</code></strong> que se produce <a href="https://nodejs.org/api/readline.html#readline_event_line">cada vez que en la entrada se recibe un caracter de cambio de línea</a>.</p>
<p>Hablando de eventos, la función que se ejecuta asíncronamente recibe el nombre de <strong><em>listener</em></strong> pero tampoco es raro que se la llame <strong><em>callback</em></strong>.</p>
<p>Se habla de <strong>registrar un listener para un evento</strong> o <strong>escuchar por ese evento</strong> a utilizar el mecanismo que permite asociar la ejecución de una función con dicho evento.</p>
<p>Con todo, aun no puedes salir del programa. Necesitas algunos cambios más:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="co">// Añade a conversational.js</span>
<span class="va">cmd</span>.<span class="at">on</span>(<span class="st">&#39;line&#39;</span><span class="op">,</span> <span class="kw">function</span> (input) <span class="op">{</span>
  <span class="cf">if</span> (input <span class="op">===</span> <span class="st">&#39;salir&#39;</span>) <span class="op">{</span>
    <span class="va">cmd</span>.<span class="at">close</span>()<span class="op">;</span>
  <span class="op">}</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">cmd</span>.<span class="at">on</span>(<span class="st">&#39;close&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;¡Nos vemos!&#39;</span>)<span class="op">;</span>
  <span class="va">process</span>.<span class="at">exit</span>(<span class="dv">0</span>)<span class="op">;</span> <span class="co">// sale de node.</span>
<span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p>Has añadido un segundo lístener al evento <code>line</code> y <strong>ambos se ejecutarán</strong>. El primero gestiona el funcionamiento por defecto (que es repetir lo que has puesto) y el segundo trata específicamente el comando <code>salir</code>.</p>
<p>Si la línea es exactamente <code>salir</code>, cerraremos la interfaz de línea de comandos. Esto produce un evento <code>close</code> y cuando lo recibamos, utilizaremos el <em>listener</em> de ese evento para terminar el programa.</p>
<p>El método <code>on()</code> es un segundo nombre para <a href="https://nodejs.org/api/events.html#events_emitter_addlistener_eventname_listener"><code>addListener()</code></a>.</p>
<p>Igual que puedes añadir un lístener, también puedes eliminarlo con <a href="https://nodejs.org/api/events.html#events_emitter_removelistener_eventname_listener"><code>removeListener()</code></a> y quitarlos todos con <a href="https://nodejs.org/api/events.html#events_emitter_removealllisteners_eventname"><code>removeAllListeners()</code></a>.</p>
<p>Puedes escuchar por un evento <strong>sólo una vez</strong> con <a href="https://nodejs.org/api/events.html#events_emitter_once_eventname_listener"><code>once()</code></a>.</p>
<h3 id="emisores-de-eventos">Emisores de eventos</h3>
<p>Esta sección presenta la clase EventEmitter que es específica de node.</p>
<p>Los eventos <strong>no son un mecanismo estándar</strong> de JavaScript. Son una forma conveniente de modelar determinados tipos de problema pero un objeto JavaScript, por sí solo, <strong>no tiene API para emitir eventos</strong>.</p>
<p><strong>En node</strong>, para que nuestros objetos emitan eventos, tenemos varias alternativas:</p>
<ul>
<li class="fragment">Implementar nuestra propia API de eventos.</li>
<li class="fragment">Hacer que nuestros objetos <strong>usen</strong> una instancia de <code>EventEmitter</code>.</li>
<li class="fragment">Hacer que nuestros objetos <strong>sean instancias</strong> de <code>EventEmitter</code>.</li>
</ul>
<p>La primera supone crear nuestro propio método <code>on()</code> y los mecanismos para emitir eventos. El segundo y el tercero usan la clase <a href="https://nodejs.org/api/events.html#events_class_eventemitter"><code>EventEmitter</code></a> que ya implementa esta API.</p>
<p>Implementaremos la opción 3 para practicar la herencia:</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> events <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;events&#39;</span>)<span class="op">;</span>
<span class="kw">var</span> EventEmitter <span class="op">=</span> <span class="va">events</span>.<span class="at">EventEmitter</span><span class="op">;</span>

<span class="kw">function</span> <span class="at">Nave</span>() <span class="op">{</span>
  <span class="va">EventEmitter</span>.<span class="at">apply</span>(<span class="kw">this</span>)<span class="op">;</span>
  <span class="kw">this</span>.<span class="at">_ammunition</span> <span class="op">=</span> <span class="st">&#39;laser charges&#39;</span><span class="op">;</span>
<span class="op">}</span>
<span class="va">Nave</span>.<span class="at">prototype</span> <span class="op">=</span> <span class="va">Object</span>.<span class="at">create</span>(<span class="va">EventEmitter</span>.<span class="at">prototype</span>)<span class="op">;</span>
<span class="va">Nave</span>.<span class="va">prototype</span>.<span class="at">constructor</span> <span class="op">=</span> Nave<span class="op">;</span>

<span class="kw">var</span> nave <span class="op">=</span> <span class="kw">new</span> <span class="at">Nave</span>()<span class="op">;</span>
<span class="va">nave</span>.<span class="at">on</span><span class="op">;</span> <span class="co">// ¡existe!</span></code></pre></div>
<p>Ahora que nuestra nave puede emitir eventos, vamos a hacer que dispare y que emita un evento.</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="va">Nave</span>.<span class="va">prototype</span>.<span class="at">shoot</span> <span class="op">=</span> <span class="kw">function</span> () <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;PICHIUM!&#39;</span>)<span class="op">;</span>
  <span class="kw">this</span>.<span class="at">emit</span>(<span class="st">&#39;shoot&#39;</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">_ammunition</span>)<span class="op">;</span> <span class="co">// parte de la API de EventEmitter.</span>
<span class="op">};</span>

<span class="va">nave</span>.<span class="at">on</span>(<span class="st">&#39;shoot&#39;</span><span class="op">,</span> <span class="kw">function</span> (ammunition) <span class="op">{</span>
  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;CENTRO DE MANDO. La nave ha disparado:&#39;</span><span class="op">,</span> ammunition)<span class="op">;</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">nave</span>.<span class="at">shoot</span>()<span class="op">;</span></code></pre></div>
<p>Emitir un evento consiste en llamar al método <a href="https://nodejs.org/api/events.html#events_emitter_emit_eventname_arg1_arg2"><code>emit()</code></a> que hará que se ejecuten los <em>listeners</em> escuchando por tal evento.</p>
<p>Los eventos son increiblemente útiles para modelar interfaces de usuario de forma genérica.</p>
<p>Para ello, los <strong>modelos deben publicar qué les ocurre</strong>: cómo cambian, qué hacen... Todo <strong>a base de eventos</strong>. Las <strong>interfaces de usuario se suscribirán</strong> a estos eventos y proporcionarán la información visual adecuada.</p>
<p>Este modelo permite además que varias interfaces de usuario funcionen al mismo tiempo, todas escuchando por los mismos eventos aunque también permite partir la interfaz en otras especializadas, cada una escuchando por un determinado conjunto de eventos.</p>
</section>
    </div>
  </div>

  <script src="../shared/lib/reveal/lib/js/head.min.js"></script>
  <script src="../shared/lib/reveal/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        // Optional reveal.js plugins
        dependencies: [
          { src: '../shared/lib/reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: '../shared/lib/reveal/plugin/zoom-js/zoom.js', async: true },
          { src: '../shared/lib/reveal/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
